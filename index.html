<html>

<head>
  <title>Index</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="header">
    <h1> Cadastro de Produto</h1>
    <button id='button' class='btn btn-primary'> Listagem </button>
  </div>
  <div class='box'>
    <form id='form'>
      <h3>Nome do Produto</h3>
      <input type='text' id='name' required>
      <h3>Descrição do Produto</h3>
      <input type='text' id='description' required>
      <h3>Valor do Produto</h3>
      <input type='text' id='value' pattern='^\d+(,\d{1,2})?$' required>
      <h3>Disponibilidade de Venda</h3>
      <select id="available">
        <option value='yes'>SIM</option>
        <option value='no'>NÃO</option>
      </select>
      <br />
      <br />
      <input type="submit" class="btn btn-primary">
    </form>
  </div>

  <script>
    document.getElementById('button').addEventListener('click', (event) => {
      event.preventDefault();

      window.location.replace("listaprodutos.html");
    })
    document.getElementById("form").addEventListener("submit", async (event) => {
      event.preventDefault();


      const module = await import('./main.js');

      const name = document.getElementById('name').value;
      const description = document.getElementById('description').value;
      const value = document.getElementById('value').value;
      const available = document.getElementById('available').value;

      const retorno = await module.cadastro(name, description, value, available);

      if (retorno == true) {
        window.location.replace("listaprodutos.html");
      } else {
        alert('Erro no cadastro')
      }

    })
  </script>
</body>

</html>